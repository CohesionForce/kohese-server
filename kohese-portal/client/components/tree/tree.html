<div id="top-action-bar">
	<button ng-click="treeCtrl.expandAll()" class="btn btn-default btn-sm"
		style="margin: 5px">Expand All</button>
	<button ng-click="treeCtrl.collapseAll()"
		class="btn btn-default btn-sm" style="margin: 5px">Collapse All</button>
    <button
            class="btn btn-default btn-sm"
            ng-click="treeCtrl.resetRoot()">
        Reset Root
    </button>
	<i ng-click="treeCtrl.syncLocation()"
		ng-class="{ 'button-selected' :treeCtrl.locationSynced}"
		class="btn btn-default btn-sm fa fa-exchange"> </i>
    <span class="pull-right"> 
	    <span>Showing {{treeCtrl.getItemMatchedCount()}} of {{treeCtrl.treeRoot.descendantCount}}</span> 
	    <span class="control-group">
		    <label class="control-label" for="Kind"> Kind </label>
		    <span class="controls">
                <select id="Kind"
                        ng-model="treeCtrl.filter.kind">
                    <option></option>    
                    <option ng-repeat="kind in treeCtrl.kindList">{{kind.modelName}}</option>
                 </select>
            </span>
	    </span>
	    <span ng-if="treeCtrl.filter.kind === 'Action'" class="control-group">
		    <label class="control-label" for="ActionState"> State </label>
		    <span class="controls">
                <select id="actionState"
                        ng-model="treeCtrl.filter.actionState">
                    <option></option>    
                    <option ng-repeat="state in treeCtrl.actionStates">{{state.item.name}}</option>
                 </select>
            </span>
	    </span>
	    <span ng-if="treeCtrl.filter.kind === 'Action'" class="control-group">
		    <label class="control-label" for="Assignee"> Assignee </label>
		    <span class="controls">
                <select id="actionAssignee"
                        ng-model="treeCtrl.filter.actionAssignee">
                    <option></option>    
                    <option ng-repeat="user in treeCtrl.userList">{{user.item.name}}</option>
                 </select>
            </span>
	    </span>
      <span class="control-group">
        <label class="control-label" for="Modified"> Modified </label>
        <input type="checkbox" ng-model="treeCtrl.filter.status"/>
      </span>	    
	    <input
		    class="input-sm" type="text" ng-model="treeCtrl.filter.text"
		    placeholder="Filter" style="margin: 5px" />
	</span>
</div>

<div class="knowledge-tree-panel">
  <div id="theKT" class="knowledge-tree" style="width:45%; display:inline-block">
	<div class="kt-head">
		<div class="kth-cell kti-name">Name</div>
		<div class="kth-cell pull-right">
			<i class="glyphicon glyphicon-plus pull-right"
				ui-sref="kohese.explore.create()"
				ng-click="treeCtrl.updateTab('create')"></i>
		</div>
	</div>
	<div class="kt-body">
        <tree-row tree-ctrl="treeCtrl" proxy-collection="treeCtrl.treeRoot.children"></tree-row>
	</div>
  </div>
  <div style="height:100%; width:54%; vertical-align: top; display:inline-block; overflow:auto"
       ng-if="treeCtrl.selectedItemProxy.item">
    <table class="table table-striped table-condensed table-hover">
      <thead>
        <th><a href="" ng-click="itemSortField = 'item.kind'">Kind</a></th>
        <th><a href="" ng-click="itemSortField = 'item.name'">Name</a></th>
        <th><a href="" ng-click="itemSortField = 'item.actionState'">State</a></th>
        <th><a href="" ng-click="itemSortField = 'item.assignedTo'">Assigned To</a></th>
        <th><a href="" ng-click="itemSortField = 'item.tags'">Tags</a></th>
        <th><i class="glyphicon glyphicon-plus pull-right"
           ng-click="treeCtrl.createChildOfSelectedItem()"></i></th>
      </thead>
      <tbody>
        <tr ng-repeat="proxy in filteredItems = (treeCtrl.selectedItemProxy.children  | filter:{item: {$: treeCtrl.filter.text}}) | orderBy:itemSortField">
          <td>{{proxy.kind}}<span ng-if="proxy.children.length > 0"> ({{proxy.children.length}})</span></td>
          <td ng-click="treeCtrl.navigate('kohese.explore.edit', 'dualview', proxy.item.id)"
              class="tree-label"
              ng-bind-html="proxy.item.name | highlight:treeCtrl.filter.text"></td>
          <td>
            <span ng-if="proxy.kind==='Decision'">{{proxy.item.decisionState}}</span>
            <span ng-if="proxy.kind==='Action'">{{proxy.item.decisionState}}/{{proxy.item.actionState}}</span>
            <span ng-if="proxy.kind==='Task'">{{proxy.item.taskState}}</span>
            <span ng-if="proxy.kind==='Issue'">{{proxy.item.issueState}}</span>
          </td>
          <td>{{proxy.item.assignedTo}}</td>
          <td>{{proxy.item.tags}}</td>
          <td class="pull-right">
            <i class="glyphicon glyphicon-remove" ng-click="treeCtrl.removeItem(proxy.item)"></i>
          </td>
        </tr>
      </tbody>
    </table>
  </div>    
</div>
