<div *ngFor="let property of contents">
  <ng-container *ngIf="property.tableDefinition else notTable">
    <label *ngIf="!property.hideLabel" style="font-weight: bold;">{{property.
      propertyName.attribute}}:
    </label>
    <ng-container *ngIf="(property.propertyName.kind === proxy.model.
      item.name)">
      <div style="height: 40px; width: 100%;">
        <button mat-button style="background-color: whitesmoke"
          [disabled]="!editable" (click)="openProxySelectionDialog(property)">
          Select {{property.propertyName.attribute}}
        </button>
      </div>
      <div style="height: 50px; width: 100%; display: flex; flex-direction: row;">
        <button mat-icon-button class="flex-right-align"
          [disabled]="(!editable || (kTable.selection.length === 0) ||
          !mayMoveSelection(true, property))" (click)="moveSelection(true,
          property)">
          <mat-icon class="fa fa-arrow-up"></mat-icon>
        </button>
        <button mat-icon-button [disabled]="(!editable || (kTable.selection.
          length === 0) || !mayMoveSelection(false, property))"
          (click)="moveSelection(false, property)">
          <mat-icon class="fa fa-arrow-down"></mat-icon>
        </button>
        <button mat-icon-button [disabled]="(!editable || (kTable.selection.
          length === 0))" (click)="removeSelection(property)">
          <mat-icon class="fa fa-remove"></mat-icon>
        </button>
      </div>
    </ng-container>
    <k-table #kTable [tableDefinition]="getTableDefinition(property)"
      [rows]="getRows(property)" [editable]="(editable && (property.
      propertyName.kind === proxy.model.item.name))">
    </k-table>
  </ng-container>
  <ng-template #notTable>
    <ng-container *ngIf="(property.kind === 'number')">
      <mat-form-field style="width: 100%;">
        <input matInput type="number" placeholder="{{property.hideLabel ? '' :
          (property.customLabel ? property.customLabel : property.propertyName.
          attribute)}}" [disabled]="!editable" [(ngModel)]="proxy.item[
          property.propertyName.attribute]"/>
      </mat-form-field>
    </ng-container>
    <ng-container *ngIf="(property.kind === 'date')">
      <mat-form-field style="width: 100%;">
        <input matInput type="date" placeholder="{{property.hideLabel ? '' :
          (property.customLabel ? property.customLabel : property.propertyName.
          attribute)}}" [disabled]="!editable" [(ngModel)]="proxy.item[
          property.propertyName.attribute]"/>
      </mat-form-field>
    </ng-container>
    <div *ngIf="['text', 'user-selector'].includes(property.kind)">
      <label *ngIf="!property.hideLabel && !property.customLabel"
        style="font-weight: bold;">
        {{property.propertyName.attribute}}:
      </label>
      <label *ngIf="!property.hideLabel && property.customLabel" style="font-weight: bold;">{{property.customLabel}} : </label>
      <div *ngIf="!editable">
        {{proxy.item[property.propertyName.attribute]}}
      </div>
      <div *ngIf="editable">
        <textarea style="background-color: white;" matInput
          matTextareaAutosize #description [(ngModel)]="proxy.item[property.
          propertyName.attribute]">
        </textarea>
      </div>
    </div>
    <div *ngIf="property.kind === 'markdown'">
      <kd-markdown [property]="property" [editable]="editable" [proxy]="proxy" [container]="'list'"></kd-markdown>
    </div>
    <div *ngIf="property.kind === 'proxy-selector'">
        <kd-proxy-selector [property]="property" [editable]="editable" [proxy]="proxy" [multiselect]="property.inputOptions.options.allowMultiSelect"></kd-proxy-selector>
    </div>
    <div *ngIf="property.kind === 'state-editor'">
      <k-state-editor [itemProxy]="proxy" (stateChanged)="stateChanged($event.fieldName, $event.candidate)"></k-state-editor>
    </div>
    <div *ngIf="property.kind === 'select'">
      Select not implemented
      <!-- <label *ngIf="!property.hideLabel" style="font-weight: bold;">{{property.propertyName}} : </label> -->
    </div>
    <div *ngIf="property.kind === 'read-only'">
      <label *ngIf="!property.hideLabel" style="font-weight: bold;">
        {{property.propertyName.attribute}}:
      </label>
      <div *ngIf="!editable">
        {{proxy.item[property.propertyName.attribute]}}
      </div>
      <div *ngIf="editable">
        {{property.propertyName.attribute}} not available for editing
      </div>
    </div>
  </ng-template>
</div>
