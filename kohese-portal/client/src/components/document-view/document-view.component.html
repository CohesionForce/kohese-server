<div class="panel right-zone" [ngClass]="{'details-doc' : incrementalLoad}">
  <div class="panel-heading">
    <button mat-icon-button class="fa fa-list" *ngIf="!fullscreen" (click)="navigate('Document', {id : itemProxy.item.id})"></button>
    Document View
    <span class="pull-right">({{itemsLoaded}}/{{itemLength}}) </span>
  </div>
  <div class="body-container">
    <div class="panel-body doc-view" #docView>
      <div data-infinite-scroll [infiniteScrollDistance]="2" [infiniteScrollThrottle]="50" (scrolled)="onScroll()" [scrollWindow]="false"
        [fromRoot]="true" [immediateCheck]="true" [infiniteScrollContainer]="'.doc-view'">
        <div (mouseenter)="row.rowState = 'show'" #row (mouseleave)="row.rowState = 'hide'" *ngFor="let docInfo of loadedProxies"
          [ngClass]="{'hovered-row': row.rowState === 'show'}" style="background-color: lightgray;">
          <creation-row  [referenceProxy]="docInfo.proxy" class="document-row" *ngIf="row.addTop" [relation]="'sibling'" (itemCreated)="insertRow($event, row, 'addTop')"></creation-row>
          <div [ngClass]="{'hovered-row': row.rowState === 'show'}" style="background-color: lightgray;">
            <div style="width: 40px; display: inline-block" [ngClass]="{'hovered-actions' : row.rowState === 'show'}" class="row-actions">
              <div class="button-group" *ngIf="row.rowState === 'show'">
                <button mat-icon-button class="fa fa-plus side-button" (click)="row.addTop = true" *ngIf="!row.addTop">
                  <i class="fa fa-chevron-up"></i>
                </button>
                <button mat-icon-button class="fa fa-plus side-button" (click)="row.addTop = false" *ngIf="row.addTop">
                  <i class="fa fa-times"></i>
                </button>
                <button mat-icon-button class="fa fa-clipboard side-button" (click)="showProxyDetails(docInfo.proxy)"></button>
                <button mat-icon-button *ngIf="!row.editable" class="fa fa-edit side-button" (click)="row.editable = true"></button>
                <button mat-icon-button *ngIf="row.editable" class="fa fa-save side-button" (click)="upsertItem(docInfo.proxy, row, docInfo);"></button>
                <button mat-icon-button *ngIf="row.editable" class="fa fa-times side-button" (click)="row.editable = false;"></button>
                <button mat-icon-button class="fa fa-plus side-button" (click)="row.addBottom = true" *ngIf="!row.addBottom">
                  <i class="fa fa-chevron-down"></i>
                </button>
                <button mat-icon-button class="fa fa-plus side-button" (click)="row.addBottom = false" *ngIf="row.addBottom">
                  <i class="fa fa-times"></i>
                </button>
              </div>
            </div>
            <div class="document-row" *ngIf="!row.editable" [ngClass]="{'hovered-body': row.rowState === 'show'}" [innerHTML]="docInfo.rendered">
            </div>
            <div class="document-row" *ngIf="row.editable" [ngClass]="{'hovered-body': row.rowState === 'show'}">
              <textarea matInput [(ngModel)]="docInfo.proxy.item.name"></textarea>
              <hr/>
              <textarea matInput matTextareaAutosize #description [(ngModel)]="docInfo.proxy.item.description"></textarea>
            </div>
          </div>
          <creation-row [referenceProxy]="docInfo.proxy" [relation]="'child'" *ngIf="row.addBottom" class="document-row" (itemCreated)="insertRow($event, row, 'addBottom')"></creation-row>
        </div>
      </div>
    </div>
  </div>
