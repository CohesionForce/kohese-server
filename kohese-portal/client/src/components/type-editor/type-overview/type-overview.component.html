<div style="height: 100%; width: 100%; display: flex; flex-direction: row;">
  <ng-container *ngIf="koheseType">
    <div style="height: 100%; flex: 1 1 50%;" class="pad">
      <h3>
        Type Information
      </h3>
      <mat-form-field style="width: 100%;">
        <input matInput type="text" placeholder="Name"
          [(ngModel)]="koheseType.dataModelProxy.item.name"
          [disabled]="koheseType.dataModelProxy.item.isMetaModel"/>
      </mat-form-field>
      <br/>
      <mat-form-field style="width: 100%;">
        <mat-select placeholder="Parent Type"
          [value]="koheseType.dataModelProxy.item.base"
          (selectionChange)="changeParentType($event.value)"
          [disabled]="koheseType.dataModelProxy.item.isMetaModel">
          <mat-option *ngFor="let t of (filteredTypes | mapKey)" [value]="t">
            <ng-container *ngIf="filteredTypes[t].viewModelProxy">
              <mat-icon class="{{filteredTypes[t].viewModelProxy.item.icon}}">
              </mat-icon>
            </ng-container>
            {{t}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <br/>
      <mat-form-field style="width: 100%;">
        <textarea matInput placeholder="Description" rows="3" cols="80"
          [(ngModel)]="koheseType.dataModelProxy.item.description"
          [disabled]="koheseType.dataModelProxy.item.isMetaModel">
        </textarea>
      </mat-form-field>
      <div style="width: 100%; display: flex; flex-direction: column;">
        <h3>
          Local Types
        </h3>
        <span class="flex-right-align">
          <button mat-icon-button matTooltip="Add a local type"
            (click)="addLocalType()">
            <mat-icon class="fa fa-plus"></mat-icon>
          </button>
        </span>
        <mat-list>
          <ng-container *ngFor="let localType of koheseType.dataModelProxy.
            item.localTypes">
            <mat-list-item>
              {{localType.name}}
              <span class="flex-right-align">
                <button mat-icon-button matTooltip="Edit this local type"
                  (click)="editLocalType(localType)">
                  <mat-icon class="fa fa-edit"></mat-icon>
                </button>
                <button mat-icon-button matTooltip="Remove this local type"
                  (click)="removeLocalType(localType)">
                  <mat-icon class="fa fa-trash"></mat-icon>
                </button>
              </span>
            </mat-list-item>
          </ng-container>
        </mat-list>
      </div>
    </div>
    <ng-container *ngIf="koheseType.viewModelProxy">
      <div style="height: 100%; flex: 1 1 50%;" class="pad">
        <h3>
          Display Information
        </h3>
        <mat-form-field style="width: 100%;">
          <input matInput type="text" placeholder="Name"
            [(ngModel)]="koheseType.viewModelProxy.item.modelName"/>
        </mat-form-field>
        <label>
          Icon:
          <span>
            <mat-icon class="{{koheseType.viewModelProxy.item.icon}}">
            </mat-icon>
          </span>
        </label>
        <button mat-raised-button (click)="openIconSelectionDialog()">
          Select Icon...
        </button>
        <br/>
        <br/>
        <div style="width: 100%; height: 70%; overflow: auto;">
          <div style="height: 50px; display: flex; flex-direction: row;">
            <h3>
              Tables
            </h3>
            <button mat-icon-button matTooltip="Add a table definition"
              class="flex-right-align" (click)="addTableDefinition()">
              <mat-icon class="fa fa-plus"></mat-icon>
            </button>
          </div>
          <ng-container *ngFor="let tableDefinition of Object.values(
            koheseType.viewModelProxy.item.tableDefinitions)">
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title style="align-items: center;">
                  {{tableDefinition.name}}
                </mat-panel-title>
                <button mat-icon-button matTooltip="Rename this table
                  definition" class="flex-right-align"
                  (click)="renameTableDefinition(tableDefinition.id)">
                  <mat-icon class="fa fa-i-cursor"></mat-icon>
                </button>
                <button mat-icon-button matTooltip="Remove this table
                  definition" (click)="removeTableDefinition(
                  tableDefinition.id)">
                  <mat-icon class="fa fa-trash"></mat-icon>
                </button>
              </mat-expansion-panel-header>
              <ng-template matExpansionPanelContent>
                <!-- Handle local type selection -->
                <table-editor [tableDefinition]="tableDefinition"
                  [kind]="koheseType.dataModelProxy.item">
                </table-editor>
              </ng-template>
            </mat-expansion-panel>
          </ng-container>
        </div>
      </div>
    </ng-container>
  </ng-container>
</div>
