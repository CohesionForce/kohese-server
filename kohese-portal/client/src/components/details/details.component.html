

<div id="details-panel" class="panel">
    <div class="panel-heading ">
        <span *ngIf="itemProxy.kind">{{itemProxy.kind}} Information: {{itemProxy.item.name}} </span>
        <span *ngIf="!itemProxy.kind">No Item Selected</span>
        <span class="pull-right item-actions">
            <i class="fa fa-lg fa-level-up"
                    *ngIf="itemProxy.item.parentId"
                    (click)="navigate('Explore', {id :itemProxy.item.parentId})"
                    title="Go to Parent"></i>
            <i class="fa fa-lg fa-edit"
               *ngIf="!enableEdit"
               (click)="enableEdit=true"
               title="Edit"></i>
            <span *ngIf="enableEdit"
                  class="fa fa-stack">
                <i class="fa fa-lg fa-edit fa-stack-2x stacked-parent"
                   (click)="enableEdit = false"
                   title="Cancel Edit"></i>
                <i class="fa fa-stack-1x fa-times stacked-child"
                   (click)="enableEdit = false; cancel();"
                   title="Cancel Edit"></i>
            </span>
            <i class="fa fa-lg fa-save"
               (click)="upsertItem()"
               title=" Save"
                    ></i>
            <i *ngIf="tab.type === 'singleview'" class="fa fa-clone pull-right"
               (click)="updateTab('kohese.explore.edit', itemProxy.item.id)"
               title="Split Screen">
            </i>
            <i class="fa fa-lg fa-arrows-alt" *ngIf="tab.type === 'dualview'"
               (click)="updateTab('kohese.investigate', itemProxy.item.id)"
               title="Fullscreen"></i>
        </span>
    </div>
    <div class="panel-body">
        <!-- Nav tabs -->
        <tabset id="details-tabs">
            <tab id="defaultTab" active="defaultTab.active" heading="Document">
                <button (click)="generateHTMLReport()" class="btn btn-primary">
                   Generate HTML Report
               </button>
                <button (click)="generateDOCXReport()" class="btn btn-primary">
                   Generate Word Document
               </button>
               <button
                      class= "btn btn-primary"
                      (click)="newTab('kohese.analysis',
                                {id: itemProxy.item.id})">
                      Analyze
              </button>

		           <div *ngIf="itemProxy.children.length">
                  <label class="control-label" for="showChildren"> Show Children </label> <input
                         type="checkbox" ng-checked="docShowChildren;"
                         (click)="showChildrenToggled()" />
                </div>
                <document-view item-proxy="itemProxy"
                               *ngIf="itemProxy"
                               show-children="docShowChildren" />


            </tab>
            <tab >
                 <tab-heading>Overview
                   <span ng-show="itemForm.$dirty">
                      <img src="resources/icons/versioncontrol/dirty.ico"
                      title = "Dirty item" />
                  </span></tab-heading>
                <div class="details-tab" *ngIf="itemProxy.kind ==='Action'">
                    <ng-include src="'components/common/templates/action-form.new.html'"></ng-include>
                </div>
                <div class="details-tab" *ngIf="itemProxy.kind != 'Action' &&
                itemProxy.kind != 'Decision' && itemProxy.kind != 'Task'
                && itemProxy.kind != 'Repository'">
                    <ng-include src="'components/common/templates/itemform.html'"></ng-include>
                </div>
                <div class="details-tab" *ngIf="itemProxy.kind ==='Task'">
                    <ng-include src="'components/common/templates/task-form.html'"></ng-include>
                </div>
                <div class="details-tab" *ngIf="itemProxy.kind ==='Decision'">
                    <accordion>
                        <ng-include src="'components/common/templates/decision-form.new.html'"></ng-include>
                    </accordion>
                </div>
                <div class="details-tab" *ngIf="itemProxy.kind ==='Repository'">
                    <ng-include src="'components/common/templates/repository-form.html'"></ng-include>
                </div>

            </tab>
            <tab *ngIf="itemProxy.kind === 'Observation'">
                <tab-heading>Observation</tab-heading>
                <ng-include src="'components/common/templates/observation-form.html'"></ng-include>
            </tab>
            <tab *ngIf="itemProxy.kind === 'Issue'">
                <tab-heading>Issue</tab-heading>
                <ng-include src="'components/common/templates/issue-form.html'"></ng-include>
            </tab>
            <tab heading="Children ({{itemProxy.children.length}})">
                <ng-include src="'components/detailsview/subviews/item.html'"></ng-include>
            </tab>
            <tab heading="Relations">
                <h4>Relations Tab</h4>

                <p><b>This tab is under construction.</b></p>
            </tab>
            <tab heading="History" select="getHistory()">
                <h4>History Tab</h4>

                <div style="width:20%; overflow:auto; display:inline-block;">
                  <label>Created by: {{itemProxy.item.createdBy}}</label>
                  <label>Created on: {{itemProxy.item.createdOn | date:'medium'}}</label>
                  <label>Modified by: {{itemProxy.item.modifiedBy}}</label>
                  <label>Modified on: {{itemProxy.item.modifiedOn | date:'medium'}}</label>
                </div>
                <div class="pull-right" style="width:78%; vertical-align: top; display:inline-block; overflow:auto">
                  <table>
                      <thead>
                        <th style="width:30%">Commit</th>
                        <th style="width:45%">Message</th>
                        <th style="width:10%">Author</th>
                        <th style="width:14%">Date</th>
                      </thead>
                      <tbody id="theDetailsBody">
                        <tr ng-repeat="record in itemProxy.history" style="vertical-align: top;">
                          <td>{{record.commit}}</td>
                          <td>{{record.message}}</td>
                          <td>{{record.author}}</td>
                          <td>{{record.date | date:'medium'}}</td>
                        </tr>
                      </tbody>
                  </table>
                  <label >{{record}}</label>
                </div>

            </tab>
            <tab heading="Journal">
                <h4>Journal Tab</h4>

                <p><b>This tab is under construction.</b></p>
            </tab>
            <tab heading="Action Table"
                 *ngIf="itemProxy.children">

              <action-table item-proxy="itemProxy">
            </tab>
            <tab heading="Raw Data">
                <h4>Document Tab</h4>
                <h5>Id: {{itemProxy.item.id}}</h5>
                <h5>OID: {{itemProxy.oid}}</h5>
                <h5>Tree Hash: {{itemProxy.treeHash}}</h5>
                <pre>{{itemProxy.document()}}</pre>
                <pre>{{itemProxy.treeHashEntry | json}}</pre>
            </tab>
        </tabset>
    </div>
    </span>
</div>
