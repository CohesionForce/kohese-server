<div style="height: 100%;">
  <ng-container *ngIf="(proxyStream | async)">
    <form [formGroup]="formGroup"
      novalidate class="form-group">
      <ng-container *ngFor="let property of (type.fields | mapKey)">
        <ng-container
          [ngSwitch]="type.fields[property].views['form'].inputType.type">
          <k-text *ngSwitchCase="'text'"
            [formGroup]="formGroup" [fieldId]="property"
            [fieldName]="type.fields[property].views['form'].displayName"
            [isMultiLine]="type.fields[property].views['form'].inputType.options['isMultiLine']">
          </k-text>
          <k-proxy-selector *ngSwitchCase="'proxy-selector'"
            [formGroup]="formGroup" [fieldId]="property"
            [type]="type.fields[property].views['form'].inputType.options['type']"
            [fieldName]="type.fields[property].views['form'].displayName"
            [useAdvancedSelector]="type.fields[property].views['form'].inputType.options['useAdvancedSelector']"
            [allowMultiSelect]="type.fields[property].views['form'].inputType.options['allowMultiSelect']"
            [editableStream]="editableStream">
          </k-proxy-selector>
          <k-date *ngSwitchCase="'date'"
            [formGroup]="formGroup" [fieldId]="property"
            [fieldName]="type.fields[property].views['form'].displayName">
          </k-date>
          <k-select *ngSwitchCase="'select'"
            [formGroup]="formGroup" [fieldId]="property"
            [fieldName]="type.fields[property].views['form'].displayName"
            [options]="type.fields[property].views['form'].inputType.options['options']">
          </k-select>
          <k-user-selector *ngSwitchCase="'user-selector'"
            [formGroup]="formGroup" [fieldId]="property"
            [fieldName]="type.fields[property].views['form'].displayName">
          </k-user-selector>
          <k-markdown *ngSwitchCase="'markdown'"
            [formGroup]="formGroup" [fieldId]="property"
            [fieldName]="type.fields[property].views['form'].displayName"
            [editableStream]="editableStream"></k-markdown>
          <br/>
        </ng-container>
      </ng-container>
    </form>
    <div id="detailsFormStateEditorContainer">
      <k-state-editor [itemProxy]="(proxyStream | async)"
        [disableTransitioning]="!(editableStream | async)"
        (stateChanged)="whenNonFormFieldChanges($event.fieldName, $event.candidate)">
      </k-state-editor>
    </div>
  </ng-container>
</div>
