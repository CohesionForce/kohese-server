<span style="font-size : large;">
    User Statistics
</span>
<button mat-button style="background-color: darkblue; color : white;"(click)="openExportDialog()">Export Text</button>
<mat-checkbox [(ngModel)]="useStates" class="pull-right" style="padding-right : 20px" (change)="buildSelectedAssignments()">
  State Filter
</mat-checkbox>
<div *ngIf="project" style="width: 100%; padding : 5px;">
  <div class="left-content">
    Select :
    <button mat-raised-button (click)="selectAll()">All</button>
    <button mat-raised-button (click)="deselectAll()">None</button>
    <mat-list>
      <mat-list-item style="border: 1px solid black; padding : 10px;" *ngFor="let user of project.users" (click)="toggleUser(user)"
        [ngClass]="{'selected-user' : selectedUserMap.get(user.item.name)}">
        <mat-icon class="fa fa-user"></mat-icon>{{ user.item.name}}
      </mat-list-item>
    </mat-list>
  </div>
  <div class="middle-content" style="overflow: auto">
    <mat-table *ngIf="selectedAssignments" [dataSource]="tableStream">
      <ng-container matColumnDef="kind">
        <mat-header-cell *matHeaderCellDef> Kind </mat-header-cell>
        <mat-cell *matCellDef="let assignment"> {{assignment.kind}}</mat-cell>
      </ng-container>
      <ng-container matColumnDef="name">
        <mat-header-cell *matHeaderCellDef> Name </mat-header-cell>
        <mat-cell *matCellDef="let assignment"> {{assignment.item.name}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="state">
        <mat-header-cell *matHeaderCellDef> State </mat-header-cell>
        <mat-cell *matCellDef="let assignment">{{assignment.state}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="assignedTo">
        <mat-header-cell *matHeaderCellDef> Assigned To </mat-header-cell>
        <mat-cell *matCellDef="let assignment"> {{assignment.item.assignedTo}}</mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="rowDef"></mat-header-row>
      <mat-row (click)="openProxyDetails(proxy)" *matRowDef="let proxy; columns: rowDef">
      </mat-row>
    </mat-table>
  </div>
  <div class="right-content" style="overflow: auto;" *ngIf="useStates">
    <div *ngFor="let type of supportedTypes">
      <h5 style="border-bottom : 1px darkgrey solid; padding-top : 10px">{{type}}</h5>
      <div *ngFor="let stateType of stateInfo[type] | mapKey">
        <h6>{{stateType}}</h6>
        <mat-list>
          <mat-list-item class="state-item" *ngFor="let state of stateInfo[type][stateType].states" (click)="toggleState(type, stateType, state)"
            [ngClass]="{'selected-state' : selectedStatesMap.get(stateType + state)}">
            {{state}}
          </mat-list-item>
        </mat-list>
      </div>
    </div>
  </div>
</div>
