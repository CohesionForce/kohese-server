<div class="kt-item" id="{{treeRow.itemProxy.item.id}}"
  matTooltip="{{treeRow.itemProxy.item.name}}"
  (click)="navigate('Explore', {id: treeRow.itemProxy.item.id})"
  [ngClass]="{ 'kti-selected-item': (treeRow.itemProxy.item.id === (selectedProxyIdStream | async)),
  'highlight-row': (treeRow.visible && treeRow.matchesFilter) }"
  [ngStyle]="getIndentationStyle()">
  <i class="kt-icon fa"
    (click)="treeRow.expanded = !treeRow.expanded; treeRow.updateVisibleRows.next(true); $event.stopPropagation()"
    [ngClass]="{ 'fa-caret-down': (treeRow.itemProxy.children.length > 0) && treeRow.expanded,
    'fa-caret-right': (treeRow.itemProxy.children.length > 0) && !treeRow.expanded,
    'no-children': !(treeRow.itemProxy.children.length > 0) }">
  </i>
  <ng-container *ngIf="koheseType.icon">
    <mat-icon matTooltip="{{koheseType.name}}"
      class="kt-icon {{koheseType.icon}}">
    </mat-icon>
  </ng-container>
  <ng-container *ngIf="!koheseType.icon">
    <span class="kt-icon no-icon"></span>
  </ng-container>
  <span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
    {{treeRow.itemProxy.item.name}}
    <ng-container *ngIf="treeRow.itemProxy.item.tags">
      {{treeRow.itemProxy.item.tags}}
    </ng-container>
  </span>
  <!-- Conditional Icons for Item status -->
  <ng-container *ngIf="treeRow.itemProxy.dirty">
    <img src="assets/icons/versioncontrol/dirty.ico" title="Dirty item"/>
  </ng-container>
  <span id="rightSpan">
    <!-- VC Status Icons -->
    <img *ngIf="treeRow.itemProxy.status['Unstaged']"
      src="assets/icons/versioncontrol/unstaged.ico"
      title="Unstaged - {{treeRow.itemProxy.status['Unstaged']}}"/>
    <img *ngIf="treeRow.itemProxy.status['Staged']"
      src="assets/icons/versioncontrol/index-mod.ico"
      title="Staged - {{treeRow.itemProxy.status['Staged']}}"/>
    <!-- Default row actions -->
    <ng-container *ngIf="'Version Control' !== (selectedViewStream | async)">
      <button mat-icon-button
        (click)="treeRootStream.next(treeRow.itemProxy); $event.stopPropagation()">
        <mat-icon class="fa fa-anchor"></mat-icon>
      </button>
      <button mat-icon-button (click)="removeItem(); $event.stopPropagation()">
        <mat-icon class="glyphicon glyphicon-remove delete-button"></mat-icon>
      </button>
      <button mat-icon-button [matMenuTriggerFor]="menu"
        (click)="$event.stopPropagation()">
        <mat-icon class="fa fa-bars"></mat-icon>
      </button>
      <mat-menu #menu="matMenu" [overlapTrigger]="false">
        <button mat-menu-item (click)="openComparisonDialog()">
          Compare With...
        </button>
      </mat-menu>
    </ng-container>
    <!-- Version Control row actions -->
    <ng-container
      *ngIf="('Version Control' === (selectedViewStream | async))">
      <!-- Actions -->
      <button mat-icon-button
        *ngIf="((treeRow.itemProxy.status | mapKey).length > 0)"
        (click)="revertChanges(); $event.stopPropagation()">
        <mat-icon class="fa fa-undo kt-icon"></mat-icon>
      </button>
      <button mat-icon-button *ngIf="treeRow.itemProxy.status['Unstaged']"
        (click)="stageChanges(); $event.stopPropagation()">
        <mat-icon class="fa fa-plus kt-icon"></mat-icon>
      </button>
      <button mat-icon-button *ngIf="treeRow.itemProxy.status['Staged']"
        (click)="unstageChanges(); $event.stopPropagation()">
        <mat-icon class="fa fa-minus kt-icon"></mat-icon>
      </button>
    </ng-container>
  </span>
</div>
